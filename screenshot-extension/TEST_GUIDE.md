# 测试指南

## 安装和基本测试

### 第一步：安装插件

1. 打开 Chrome 浏览器
2. 在地址栏输入 `chrome://extensions/`
3. 启用右上角的 **开发者模式**
4. 点击 **加载已解压的扩展程序**
5. 选择 `screenshot-extension` 文件夹
6. 插件应该出现在列表中，状态为"已启用"

### 第二步：验证插件加载

1. 在 `chrome://extensions/` 中找到"页面截图工具"
2. 检查是否显示版本号 `1.0.0`
3. 点击 **详情** 查看权限列表
4. 确保没有显示错误信息

## 功能测试

### 测试 1：可见区域截图（最简单）

**步骤：**
1. 访问任何网站（如 https://www.google.com）
2. 点击浏览器右上角的插件图标
3. 点击 **可见区域截图** 按钮
4. 等待 2-3 秒
5. 检查下载文件夹中是否有 `screenshot-visible-*.png` 文件

**预期结果：**
- 弹窗显示 "✓ 截图已保存"
- 下载文件夹中出现新的 PNG 文件
- 文件大小 > 100KB

### 测试 2：全页面截图

**步骤：**
1. 访问一个较长的网页（如 https://www.wikipedia.org）
2. 点击插件图标
3. 点击 **全页面截图** 按钮
4. 等待 3-5 秒（可能需要加载 html2canvas 库）
5. 检查下载文件夹

**预期结果：**
- 弹窗显示 "✓ 截图已保存"
- 文件名为 `screenshot-fullpage-*.png`
- 截图包含整个页面内容（包括滚动区域）

**调试：**
如果失败，打开 F12 控制台查看错误：
- 检查是否有 "html2canvas 库加载失败" 错误
- 检查网络连接是否正常

### 测试 3：选定区域截图

**步骤：**
1. 访问任何网站
2. 点击插件图标
3. 点击 **选定区域截图** 按钮
4. 鼠标会变成十字光标
5. 拖拽鼠标选择要截图的区域
6. 松开鼠标完成选择
7. 等待 2-3 秒

**预期结果：**
- 选择时显示蓝色虚线框
- 弹窗显示 "✓ 截图已保存"
- 文件名为 `screenshot-select-*.png`
- 截图只包含选定的区域

**调试：**
- 如果选择框不显示，检查 CSS 是否正确加载
- 如果截图失败，尝试选择更大的区域

## 高级测试

### 测试 4：不同网站兼容性

测试以下网站：

| 网站 | URL | 预期结果 |
|------|-----|--------|
| Google | https://www.google.com | ✓ 应该成功 |
| Wikipedia | https://www.wikipedia.org | ✓ 应该成功 |
| GitHub | https://www.github.com | ✓ 应该成功 |
| YouTube | https://www.youtube.com | ⚠️ 可能有限制 |
| Facebook | https://www.facebook.com | ⚠️ 可能有限制 |

### 测试 5：边界情况

**测试 5.1：非常长的页面**
- 访问 https://www.wikipedia.org/wiki/List_of_countries_by_population
- 进行全页面截图
- 验证整个页面都被截图

**测试 5.2：动态内容**
- 访问 https://www.google.com
- 搜索某个关键词
- 进行截图
- 验证搜索结果被正确截图

**测试 5.3：快速连续截图**
- 点击 **可见区域截图**
- 立即再点击一次
- 验证两个截图都成功保存

### 测试 6：错误处理

**测试 6.1：无效的网站**
- 尝试在 `about:blank` 页面截图
- 应该显示错误信息

**测试 6.2：网络错误**
- 断开网络连接
- 尝试全页面截图（需要加载 html2canvas）
- 应该显示错误信息

## 性能测试

### 测试 7：响应时间

| 操作 | 预期时间 | 实际时间 |
|------|---------|--------|
| 可见区域截图 | < 2 秒 | _____ |
| 全页面截图（第一次） | < 5 秒 | _____ |
| 全页面截图（第二次） | < 3 秒 | _____ |
| 选定区域截图 | < 3 秒 | _____ |

## 日志检查

### 检查 Content Script 日志

1. 打开要截图的网页
2. 按 `F12` 打开开发者工具
3. 切换到 **Console** 标签
4. 应该看到以下日志：
   ```
   Content script 已加载
   Content script 收到消息: captureFullPage
   html2canvas 库加载成功
   截图已发送
   ```

### 检查 Service Worker 日志

1. 打开 `chrome://extensions/`
2. 找到插件，点击 **详情**
3. 在 **检查视图** 下点击 **service worker**
4. 应该看到以下日志：
   ```
   Background 收到消息: captureFullPage
   ```

## 测试报告模板

```
测试日期: ___________
测试人员: ___________
Chrome 版本: ___________

测试结果:
- 可见区域截图: [ ] 通过 [ ] 失败
- 全页面截图: [ ] 通过 [ ] 失败
- 选定区域截图: [ ] 通过 [ ] 失败

问题描述:
_________________________________

建议:
_________________________________
```

## 自动化测试

### 使用 Chrome DevTools Protocol (CDP)

可以使用 Puppeteer 或 Playwright 进行自动化测试：

```javascript
const browser = await puppeteer.launch();
const page = await browser.newPage();
await page.goto('https://www.google.com');
// 触发截图插件
// 验证文件是否生成
await browser.close();
```

## 完成检查清单

- [ ] 插件成功加载
- [ ] 可见区域截图正常工作
- [ ] 全页面截图正常工作
- [ ] 选定区域截图正常工作
- [ ] 截图文件正确保存
- [ ] 没有控制台错误
- [ ] 响应时间在预期范围内
- [ ] 多个网站都能正常工作
